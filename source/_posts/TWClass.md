title: 思沃大讲坛笔记
date: 2015-10-17 13:18:24
tags:
- linux
- ThoughtWorks
- note
categories:
- Tech

---
1. [第一课:linux基础](#linux基础)

# Linux基础
推荐一个网站[<鸟哥的linux私房菜>](http://vbird.dic.ksu.edu.tw/linux_basic/linux_basic.php),也可以买这本书.
## What is Linux
参考这个:[linux是什么](http://vbird.dic.ksu.edu.tw/linux_basic/0110whatislinux.php),需要说明的几点是:
* linux只是一个操作系统内核,与其他[GNU]()组织开发的工具组合在一起组成GNU/Linux操作系统.
* 自从使用git来管理linux内核的代码以后,不再使用奇偶数来标识内核的稳定版和开发板.
* linux 是宏内核,linux大部分设备驱动是写在内核里面的,linux提供了以内核模块的方式插入驱动程序.
<!--more-->
# Basic Shell command
1. pwd: print working directory, 打印出当前工作目录.
2. ls : list 列出内容 
 + -a --all 包含隐藏文件/目录(.开头)
 + -l --long 以长格式列出文件/目录信息.就是列出文件类型,权限,所属用户所属组等这些东西
 + -F --classify 使用(\*/=\>@|)来标识文件或目录类型.\*表示可执行文件,/表示目录,@表示链接文件,|表示管道文件,=表示套接字文件,\>代表什么我还真不知道,木有见过额......
3. cd : change directory 切换目录.
 + 绝对路径:从根出发到达某一目录/文件的路径.
 + 相对路径:从当前路径出发到达某一目录/文件的路径
 + . : 当前目录
 + ..:上一层目录
4. mkdir: make directory 创建目录
 + -p --parent: 创建目录时创建丢失的父目录,也就是可以创建多层目录
5. rmdir: remove **empty** directories 删除**空**目录
6. cp: copy 复制
 + -r --recursive : 递归复制,复制目录必须加上-r选项.
 + -a : 复制所有属性,包括所有者,所属组及其权限.在使用cp备份文件时用的多.
7. rm: remove 删除文件/目录
 + -r :递归删除,删除目录时必须使用该选项. 
 + -f :忽略不存在的文件或者参数,即使你的参数错误也不给出错误提示.常常用于强制删除,不给出提示.
8. mv: move and rename file or directories 
 + -u --update:只有当源文件比目标文件更新或者目标文件本来就不存在时在执行mv,常用与备份.
9. touch : use to create a file or change the timestamp of file ,实际上该命令是用来更改文件的时间戳的.但是默认情况下如果文件不存在则会新建一个文件.
 + 一个文件有三个时间戳,这里不深究先.
10. cat : 连接文件,并将文件内容打印出来.
 + 常用于将文本文件内容输出在标准输出.例如:`cat /etc/passwd`
 + 不带参数时会从标准输入读取,然后输出到标准输出.
 + 可以使用`here-document(<<)`,不深究先
11. tac : 逆向输出文件.可以看到,这个命令是cat的逆转
12. head/tail: 查看文件头/末尾几行
 + -{NUM} 输出头/末尾NUM行
 + tail -F :如果有进程在写入该文件,那么将实时的显示进程写入的内容.一般用于日志查看. 
13. less/more: 用于滚动查看文件内容.
 + less可上下滚动,且支持vim的上下滚动方式(hjkl)而且支持vim的模式匹配(/),所以使用less就够了.
14. wc: word count 计算文本的行数,单词数,字符数.
 + -l --line 计算行数.
 + -w --word 计算单词数.关于颜王哥在课堂上说的为什么/etc/passwd文件的单词数只有六十几个的答案是:默认判断单词的分割符是空格,而该文件用:作为字段分割符.验证方法是,将空格换成回车,然后计算行数.
 + -c/-m 计算字符数.
15. find: 查找文件.这个命令非常强大,但是我并不怎么常用...缺点:遍历硬盘查找,慢.
 + -name {filename} 按名称查找文件.
 + -type {bcdpflsD} 按文件类型查找.
16. locate 在数据库中查找文件或目录.这个我常用.缺点:当有新文件加入时,数据库更新不及时可能需要手动更新数据库:`sudo updatedb`
 + 有些发行版默认情况下没有安装该包,如果该命令不存在请安装mlocate包.
17. file 查看文件类型:ASCII文本?可执行程序?
18. type 查看命令类型:shell内建命令?命令别名?
19. **man** 查看命令详细文档

## 管道及重定向
文件描述符中0,1,2已经被定义,分别为:标准输入,标准输出,标准错误输出.
1. (未命名)管道`|`,用于把上一个命令的输出作为下一个命令的输入.
例如:`cat /etc/passwd | awk -F':' '{print $1" "$2}'`,这个例子中把cat命令的输出作为后一条命令awk的输入.最后是打印了/etc/passwd文件中第一个和第二个字段的内容.
2. `>` 标准输出重定向(覆盖模式)
例如:`ls > file`将ls命令的输出输出到文件file中,如果再次执行`free > file` 那么将覆盖前面的内容.
3. `>>` 标准输出重定向(追加模式)
例如:`free >> file2`会把free命令的内容输出到文件file2中,如果继续执行`cat /proc/meminfo >> file2`那么将在文件的后面追加cat命令输出的内容.
4. `2>` 标准错误输出重定向(覆盖模式)
例如:`find / -name gnome 2> /dev/null`将把find命令输出的错误信息重定向到/dev/null(输出黑洞)中.
5. `2>>` 标准错误输出重定向(追加模式)
例如:`find / -name awesome 2>> fileerr`将把find命令输出的错误信息重定向到fileerr后面.
6. `<` 输入重定向
7. `<<` here-document,上面有提及.
记忆方法: 两个括号的是追加模式,加上2(2是标准错误输出的文件描述符)的是标准错误输出的重定向.here-document 可以先不了解.

## network manager:
1. ping : 向目标主机发送icmp包.测试网络状况.参数可以是ip地址,也可以是域名
例如:`ping www.baidu.com`
2. telnet: 一个远古时期用来访问远程机器的工具.不够安全.参数是ip地址加端口号.
例如:`telnet www.baidu.com 80`也可以用该命令登录ftp服务器等.
3. wget: 命令行下载工具.支持断电续传.
例如:`wget cinus.me`就能下载我博客的首页文件.该命令能下载整个站点文件并转换成本地链接,详细使用请参考我另一篇博客.
4. curl: 命令行下的上传和下载工具.支持很多种协议.
例如:`curl -X GET 10.129.100.142:8080/hobbies/`这是上课时的用例,现在没法用.
5. ssh: 远程登录程序.较telnet安全不少,登录远程机器推荐使用ssh
例如:`ssh cxy@10.112.222.12`来用cxy用户登录主机xxx.xxx.xxx.xxx.前面的ip是没有意义的.
6. scp: 基于ssh的文件传输工具.用来远程文件传输
例如:`scp -P 22 cxy@10.11.23.123:/home/cxy/hello ./`会把远程主机xxx.xxx.xxx.xxx下的/home/cxy/hello 文件发送到本机当前目录.
`scp -P 22 ./hello cxy@10.11.23.123:/home/cxy/`将把本机文件复制到远程主机.当然,源和目标都可以是远程主机.就不写实例了.. 
7. netstat:查看网络状态工具.现在使用`ss`更多.
8. lsof:列出打开的文件.可以用来看套接字文件是否打开.

## 文本处理
1. grep :用于查找匹配正则表达式的文件内容.
 + -i --ignore: 忽略大小写的区别.
 + -n :打印出行号
 + -r :在目录中递归查找
2. awk: awk可以执行一段awk程序来处理文本,这段程序可以直接用''包含写在命令后面,也可以写入文件,然后指定该程序文件.所以可以将其理解为一个脚本语言解释器,该命令相当强大,这里不会深挖.
 + 命令格式:`awk '条件类型1{动作1} 条件类型2{动作2} ...' filename`
 + `awk -F':' '{print $1" "$2}' /etc/passwd` 该命令执行了''中的程序:打印出第一和第二个字段.前面的-F是指定分割符为":",因为/etc/passwd文件中的字段分割符为":".
3. sed: stream editor(流编辑器).一般为一行一行处理文本,也可以读入多行一起处理.sed实际也是执行一段脚本.
```
     [cxy@ThinkPad ~]# sed [-nefr] [动作]
     选项与参数：
     -n  ：使用安静(silent)模式。在一般 sed 的用法中，所有来自 STDIN 
     的数据一般都会被列出到萤幕上。但如果加上 -n 参数后，则只有经过
     sed 特殊处理的那一行(或者动作)才会被列出来。
     -e  ：直接在命令列模式上进行 sed 的动作编辑；
     -f  ：直接将 sed 的动作写在一个文件内， -f filename 则可以运行 filename 内的 
     sed 动作；
     -r  ：sed 的动作支持的是延伸型正规表示法的语法。(默认是基础正规表示法语法)
     -i  ：直接修改读取的文件内容，而不是由萤幕输出。

     动作说明：  [n1[,n2]]function
     n1, n2 ：不见得会存在，一般代表『选择进行动作的行数』，举例来说，如果我的动作
     是需要在 10 到 20 行之间进行的，则『 10,20[动作行为] 』

     function 有底下这些咚咚：
     a   ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)～
     c   ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！
     d   ：删除，因为是删除啊，所以 d 后面通常不接任何咚咚；
     i   ：插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；
     p   ：列印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行～
     s   ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配
     正规表示法！例如 1,20s/old/new/g 就是啦！
```
例如:`sed 's/root/cxy/g' /etc/passwd` 将/etc/passwd文件中的root替换为cxy,注意:这里不是改变文件内容,只是将处理后的文本内容输出在标准输出上,如果想直接修改文本需要加上参数-i,此时得注意你有写该文件的权限.

## 系统管理
1. sudo: 临时切换用户(组)来执行命令.有些同学的账户不能使用sudo命令,因为没有被授权.最简单的一个方法是:
执行`visudo`找到`root    ALL=(ALL:ALL) ALL`在下一行加上`{your UserName}     ALL=(ALL:ALL) ALL`,保存退出.如果输入有错误那么将会报错,如果成功退出,表示修改成功
用法:`sudo command`接下来你需要输入当前用户名的密码,成功后将使用root用户来运行command,在未来5分钟以内执行sudo你将不需要输入密码.该时间可以在配置文件中修改.
3. dpkg: Debian系列的包管理器,一般用于自己下载.deb包的安装,和查看本地安装了哪些包
 + -i --install: 安装一个安装包.
 + -r --remove: 移除一个安装包.
2. apt: Debian系列的包管理器,包装可dpkg相对较高级,可以自动解决依赖问题.
 + update: 更新源信息`sudo apt update`
 + upgrade: 更新本地包`sudo apt upgrade`
 + search: 查找某包: `apt search mlocate`
 + install: 安装一个包`sudo apt install mlocate`
 + remove: 删除一个包 `sudo apt remove mlocate`
4. aptitude: Debian系列更高级的包管理器.命令参数参考apt
5. pacman: ArchLinux包管理器
6. yum: 红帽系列包管理器
7. DNF: 红帽公司打算用来替换yum的包管理器.

## Basic vim usage
vim 需要讲的东西太多,这么短的篇幅来讲vim感觉很无力.也许你看着这些操作没有什么规律,但是如果你继续往深入学习下去你会发现,一切都是那么合情合理,设计优美
+ 光标移动:`hjkl`
+ 光标跳到文件头:`gg`
+ 光标跳到文件末尾:`G`
+ 光标跳到行首:`0`,光标跳到行尾:`$`
+ 在光标上一行插入文本:`O`,下一行插入文本`o` 普通模式 -/> 插入模式
+ 在当前位置进行插入:`i`,在行首进行插入:`I` 普通模式 -/> 插入模式
+ 在当前闻之进行追加:`a`,在行尾进行追加:`A` 普通模式 -/> 插入模式
+ 删除一行:`dd`
+ 撤销上一个修改:`u`
+ 重复上一次修改:`.`
+ 撤销上一个撤销:`<Ctrl-r>`
+ 复制一行:`yy`
+ 以单词为基本单位移动光标:`w`/`e`/`b` -/> 向后跳一个单词(光标在单纯首字母)/向后跳一个单词(光标在单词尾字母)/向前跳一个单词
+ 在一行上进行查找:`f`/`F`. `f`:从当前位置向行尾查找某字符 , `F`:从当前位置向行首查找某字符
+ 重复f/F操作:`;`正向重复,`,`反向重复
+ 在文本中查找光标下的单词:`#`,使用`n`和`N`来正反向查找. 
+ 匹配括号:`%`
+ 缩进:
    - 自动缩进:`=`
    - 增加一个缩进等级:`>`
    - 减小一个缩进等级:`<`
+ `v`:普通模式和可视模式的开关. 	 普通模式 <-> 可视模式
+ `V`:普通模式和行可视模式的开关.	 普通模式 <-> 行可视模式
+ `<C-v>`:普通模式和块可是模式的开关.	 普通模式 <-> 行可视模式
+ `:wq`保存退出,怕大家不不知道...T_T
+ `:q!`强制退出,不保存
+ `:h [keyword]`调出帮助文档

## 建议
+ vim 入门:[鸟哥](http://vbird.dic.ksu.edu.tw/linux_basic/0310vi.php)
+ 不会的命令问`man command`
+ 多用

有什么遗漏再来补充吧.
